<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>For My Love ‚ù§Ô∏è</title>

<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:'Patrick Hand',cursive;
  overflow:hidden;
  background:#000;
}

/* PARALLAX */
.parallax{
  position:fixed;
  inset:0;
  background:linear-gradient(120deg,#ffb6c1,#ffc0cb,#ffdde1);
  background-size:400% 400%;
  animation:bgMove 18s ease infinite;
  z-index:-2;
}
@keyframes bgMove{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

.screen{
  position:absolute;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
}
.screen.active{display:flex}

.card{
  background:#fff;
  width:90%;
  max-width:380px;
  border-radius:24px;
  padding:24px;
  text-align:center;
  box-shadow:0 20px 50px rgba(0,0,0,.3);
}

button{
  border:none;
  padding:12px 22px;
  border-radius:30px;
  font-family:inherit;
  font-size:18px;
  background:#ff7aa2;
  color:#fff;
  margin-top:15px;
}

input{
  width:100%;
  padding:12px;
  font-size:18px;
  border-radius:12px;
  border:2px solid #ddd;
  margin-top:10px;
}

/* PUZZLE */
.puzzle{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:6px;
  margin-top:15px;
}
.tile{
  width:100%;
  aspect-ratio:1;
  background-image:url('foto1.jpeg');
  background-size:300% 300%;
  border-radius:12px;
  cursor:grab;
  transition:transform .15s;
}
.tile:active{transform:scale(.95)}

.hidden{display:none}

/* CONFETTI */
.confetti{
  position:fixed;
  inset:0;
  pointer-events:none;
}
.confetti span{
  position:absolute;
  width:8px;
  height:8px;
  background:hsl(var(--h),80%,60%);
  animation:fall 3s linear infinite;
}
@keyframes fall{
  from{transform:translateY(-10px)}
  to{transform:translateY(110vh)}
}
/* ===== PATCH: BACKGROUND GERAK (LOCK) ===== */
.bg-animated{
  position:fixed;
  inset:0;
  background:
    linear-gradient(
      120deg,
      #ffb6c1,
      #ffc0cb,
      #ffdde1,
      #ffe6ee
    );
  background-size:400% 400%;
  animation:bgMoveFix 20s ease infinite;
  z-index:-5;
  pointer-events:none;
}

@keyframes bgMoveFix{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

</style>
</head>

<body>
<div class="bg-animated"></div>

<div class="parallax"></div>

<audio id="music" src="lagu-lagi.mp3" loop></audio>

<!-- PASSWORD -->
<div class="screen active" id="lock">
  <div class="card">
    <h2>üîí Secret Code</h2>
    <p>Clue 6 angka:<br>Tanggal/Bulan/Tahun</p>
    <input id="code" placeholder="contoh: 250825">
    <button onclick="unlock()">Masuk üíó</button>
  </div>
</div>

<!-- PUZZLE -->
<div class="screen" id="puzzle">
  <div class="card">
    <h2>üß© Puzzle Time</h2>
    <p>Geser potongan fotonya üíã</p>
    <div class="puzzle" id="puzzleBox"></div>
  </div>
</div>

<!-- LETTER -->
<div class="screen" id="letter">
  <div class="card">
    <h2>I Love You üíñ</h2>
    <p id="text"></p>
    <button onclick="ask()">Will you stay with me?</button>
  </div>
</div>

<!-- END -->
<div class="screen" id="end">
  <div class="card">
    <h2>üíñ She Said YES!</h2>
    <p>Hari ini, besok, dan seterusnya ü§ç</p>
    <button onclick="fadeOut()">Peluk Aku ü§ç</button>
  </div>
</div>

<div class="confetti" id="confetti"></div>

<script>
const screens=id=>document.getElementById(id);
const music=document.getElementById("music");

/* UNLOCK */
function unlock(){
  if(code.value==="250825"){
    screens("lock").classList.remove("active");
    screens("puzzle").classList.add("active");
    music.play();
    initPuzzle();
  }
}

/* PUZZLE */
let order=[...Array(9).keys()].sort(()=>Math.random()-.5);
let drag=null;

function initPuzzle(){
  puzzleBox.innerHTML="";
  order.forEach(i=>{
    let t=document.createElement("div");
    t.className="tile";
    t.style.backgroundPosition=`${(i%3)*50}% ${(~~(i/3))*50}%`;
    t.draggable=true;
    t.ondragstart=e=>drag=i;
    t.ondragover=e=>e.preventDefault();
    t.ondrop=e=>{
      let a=order.indexOf(drag);
      let b=order.indexOf(i);
      [order[a],order[b]]=[order[b],order[a]];
      initPuzzle();
      if(order.every((v,i)=>v===i)){
        setTimeout(()=>screens("puzzle").classList.remove("active")||
        screens("letter").classList.add("active")||
        typeText(),600);
      }
    }
    puzzleBox.appendChild(t);
  })
}

/* TYPEWRITER */
const msg="Terima kasih sudah hadir dan bertahan bersamaku.\nAku harap kita selalu saling memilih, di setiap hari yang datang ü§ç";
let i=0;
function typeText(){
  if(i<msg.length){
    text.innerHTML+=msg[i]==="\n"?"<br>":msg[i];
    i++; setTimeout(typeText,45);
  }
}

/* ENDING */
function ask(){
  screens("letter").classList.remove("active");
  screens("end").classList.add("active");
  for(let i=0;i<80;i++){
    let c=document.createElement("span");
    c.style.left=Math.random()*100+"%";
    c.style.setProperty("--h",Math.random()*360);
    confetti.appendChild(c);
  }
}

function fadeOut(){
  let v=music.volume;
  let f=setInterval(()=>{
    v-=.05;
    music.volume=v;
    if(v<=0){clearInterval(f);music.pause();}
  },200);
}
</script>
</body>
</html>

