<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OTP Simulator</title>

<style>
/* ===== BASE ===== */
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial;
  background: #0e1621;
  color: #e6e6e6;
}
body.light {
  background: #f3f4f6;
  color: #111827;
}

/* ===== CONTAINER ===== */
.container {
  max-width: 480px;
  margin: 0 auto;
  padding: 12px;
}

/* ===== HEADER ===== */
.app-header {
  position: sticky;
  top: 0;
  z-index: 10;
  background: #0e1621;
  border-bottom: 1px solid #1f2937;
  padding: 10px 0;
  text-align: center;
}
body.light .app-header {
  background: #f3f4f6;
  border-bottom-color: #e5e7eb;
}
.app-header .title {
  font-weight: 700;
  color: #58a6ff;
}
body.light .app-header .title { color: #2563eb; }
.app-header .status {
  font-size: 12px;
  color: #9ca3af;
  margin-bottom: 6px;
}
.app-header button {
  margin: 2px;
}

/* ===== CARD ===== */
.box {
  background: #17212b;
  padding: 14px;
  margin-bottom: 12px;
  border-radius: 12px;
}
body.light .box { background: #ffffff; }

button {
  width: 100%;
  background: #2ea6ff;
  border: none;
  color: #fff;
  padding: 12px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
}
button:disabled { opacity: .5; cursor: not-allowed; }
body.light button { background: #2563eb; }

select {
  width: 100%;
  padding: 10px;
  border-radius: 6px;
  border: 1px solid #2a3b4d;
  background: #0e1621;
  color: #e6e6e6;
}
body.light select {
  background: #ffffff;
  color: #111827;
  border-color: #d1d5db;
}

.otp {
  font-size: 26px;
  color: #4ade80;
  letter-spacing: 4px;
}

/* ===== CHAT ===== */
#feed {
  list-style: none;
  padding: 0;
  margin: 0;
}
.chat-item {
  display: flex;
  gap: 8px;
  margin-bottom: 8px;
}
.chat-left { flex-direction: row; }
.chat-right { flex-direction: row-reverse; }

.avatar {
  width: 34px;
  height: 34px;
  border-radius: 50%;
  background: #2ea6ff;
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
}
.chat-right .avatar { background: #22c55e; }

.bubble {
  background: #182533;
  padding: 10px 12px;
  border-radius: 12px;
  font-size: 13px;
  max-width: 75%;
}
.chat-right .bubble {
  background: #1f6feb;
  text-align: right;
}
body.light .bubble {
  background: #e5e7eb;
  color: #111827;
}
body.light .chat-right .bubble { background: #bfdbfe; }

/* ===== TYPING DOTS ===== */
.typing::after {
  content: '';
  animation: dots 1.2s infinite;
}
@keyframes dots {
  0% { content: ''; }
  33% { content: '.'; }
  66% { content: '..'; }
  100% { content: '...'; }
}

/* ===== BUBBLE ANIMATION ===== */
@keyframes slideInLeft {
  from { transform: translateX(-20px); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}
@keyframes slideInRight {
  from { transform: translateX(20px); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}
.chat-left .bubble { animation: slideInLeft .25s ease-out; }
.chat-right .bubble { animation: slideInRight .25s ease-out; }

.time {
  display: block;
  font-size: 11px;
  color: #9ca3af;
  margin-top: 4px;
}

/* ===== COUNTDOWN + PROGRESS ===== */
#countdown { font-size: 13px; color: #9ca3af; }
.progress-wrap {
  width: 100%;
  height: 6px;
  background: #1f2937;
  border-radius: 4px;
  overflow: hidden;
  margin-top: 6px;
}
#progressBar {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, #22c55e, #2ea6ff);
  transition: width 1s linear;
}
body.light .progress-wrap { background: #e5e7eb; }
</style>
</head>

<body>
<div class="container">

<header class="app-header">
  <div class="title">OTP Simulator</div>
  <div class="status">online ‚Ä¢ simulation</div>
  <button id="themeBtn" onclick="toggleTheme()">üåô Dark</button>
  <button id="soundBtn" onclick="toggleSound()">üîä Sound</button>
  <button onclick="previewSound()">‚ñ∂Ô∏è Preview</button>
</header>

<div class="box">
  <button onclick="getNumber()">Get Number</button>
  <p id="number"></p>
</div>

<div class="box">
  <select id="service">
    <option value="WhatsApp">WhatsApp</option>
    <option value="Telegram">Telegram</option>
  </select>
  <br><br>
  <button id="otpBtn" onclick="generateOTP()">Generate OTP</button>
  <p id="countdown"></p>
  <div class="progress-wrap"><div id="progressBar"></div></div>
  <p id="sms"></p>
  <div id="otp" class="otp"></div>
</div>

<div class="box">
  <ul id="feed"></ul>
</div>

<!-- AUDIO -->
<audio id="soundWA" preload="auto">
  <source src="https://assets.mixkit.co/sfx/preview/mixkit-message-pop-alert-2354.mp3" type="audio/mpeg">
</audio>
<audio id="soundTG" preload="auto">
  <source src="https://assets.mixkit.co/sfx/preview/mixkit-software-interface-start-2574.mp3" type="audio/mpeg">
</audio>

</div>

<script>
/* ===== DATA ===== */
let dummyNumbers = ["+999811234567","+888700000111","+777600009999"];
let index = 0;
let activeNumber = null;

/* ===== COUNTDOWN ===== */
let cooldown = 5;
let countdownTimer = null;

/* ===== THEME ===== */
function toggleTheme(){
  document.body.classList.toggle("light");
  let l = document.body.classList.contains("light");
  localStorage.setItem("theme", l?"light":"dark");
  document.getElementById("themeBtn").innerText = l?"‚òÄÔ∏è Light":"üåô Dark";
}
(function(){
  if(localStorage.getItem("theme")==="light"){
    document.body.classList.add("light");
    document.getElementById("themeBtn").innerText="‚òÄÔ∏è Light";
  }
})();

/* ===== SOUND ===== */
let soundEnabled = localStorage.getItem("sound")!=="off";
function toggleSound(){
  soundEnabled=!soundEnabled;
  localStorage.setItem("sound", soundEnabled?"on":"off");
  document.getElementById("soundBtn").innerText = soundEnabled?"üîä Sound":"üîá Sound";
}
function playSound(service){
  if(!soundEnabled) return;
  let a = service==="WhatsApp"?soundWA:soundTG;
  a.currentTime=0; a.play().catch(()=>{});
}
function previewSound(){
  playSound(document.getElementById("service").value);
}

/* ===== STORAGE ===== */
function saveFeed(){ localStorage.setItem("otpFeed", feed.innerHTML); }
(function(){
  let s = localStorage.getItem("otpFeed");
  if(s) feed.innerHTML = s;
})();

/* ===== NUMBER ===== */
function getNumber(){
  activeNumber = dummyNumbers[index];
  number.innerText = "Nomor: "+activeNumber;
  index = (index+1)%dummyNumbers.length;
}

/* ===== CORE OTP ===== */
function generateOTP(auto=false){
  if(countdownTimer && !auto) return;
  if(!activeNumber) return;

  let service = auto ? (Math.random()>0.5?"WhatsApp":"Telegram") : serviceSel.value;
  let position = service==="WhatsApp"?"chat-right":"chat-left";

  let typing = document.createElement("li");
  typing.innerHTML = `
    <div class="chat-item ${position}">
      <div class="avatar">${service[0]}</div>
      <div class="bubble typing">${service} is typing</div>
    </div>`;
  feed.appendChild(typing);
  typing.scrollIntoView({behavior:"smooth"});

  setTimeout(()=>{
    typing.remove();
    let otp = Math.floor(100000+Math.random()*900000);
    let time = new Date().toLocaleTimeString().slice(0,5);

    let li = document.createElement("li");
    li.innerHTML = `
      <div class="chat-item ${position}">
        <div class="avatar">${service[0]}</div>
        <div class="bubble">
          <b>${service}</b><br>
          ${activeNumber}<br>
          OTP: <b style="color:#4ade80">${otp}</b>
          <span class="time">${time}</span>
        </div>
      </div>`;
    feed.appendChild(li);
    li.scrollIntoView({behavior:"smooth"});
    playSound(service);
    saveFeed();

    if(!auto){
      let t=cooldown, bar=progressBar;
      otpBtn.disabled=true; bar.style.width="100%";
      countdown.innerText=`Tunggu ${t} detik`;
      countdownTimer=setInterval(()=>{
        t--; bar.style.width=(t/cooldown*100)+"%";
        countdown.innerText=`Tunggu ${t} detik`;
        if(t<=0){
          clearInterval(countdownTimer);
          countdownTimer=null;
          otpBtn.disabled=false;
          countdown.innerText="Siap generate OTP lagi";
          bar.style.width="0%";
        }
      },1000);
    }
  },1000+Math.random()*1000);
}

/* ===== AUTO ACTIVITY (FAKE REAL-TIME) ===== */
setInterval(()=>{
  if(Math.random()<0.35){
    if(!activeNumber) getNumber();
    generateOTP(true);
  }
},6000);

/* ===== SHORTCUTS ===== */
const feed=document.getElementById("feed");
const number=document.getElementById("number");
const serviceSel=document.getElementById("service");
const otpBtn=document.getElementById("otpBtn");
const countdown=document.getElementById("countdown");
const progressBar=document.getElementById("progressBar");
</script>

</body>
</html>
